Here is a professional, high-impact `README.md` for your **AI Voice Agent** workflow. It is designed to explain the architecture to developers and define the API contract for the Voice AI (e.g., Vapi, Retell, Bland AI, or OpenAI Realtime).

***

# üéôÔ∏è AI Voice Agent: Real-Time Calendar Orchestrator
**The "Function Calling" backend for Conversational AI.**

This n8n workflow acts as the deterministic execution layer for an AI Voice Agent. It allows an LLM to interface directly with **Google Calendar** to check availability, list open slots, and hard-book appointments in real-time during a conversation.

![n8n](https://img.shields.io/badge/n8n-Backend-orange) ![Google Calendar](https://img.shields.io/badge/Google-Calendar-blue) ![Webhook](https://img.shields.io/badge/API-REST-green) ![Voice AI](https://img.shields.io/badge/Ready%20for-Vapi%20%2F%20Retell-purple)

## üìñ Project Overview
When an AI Voice Agent (like Vapi or Retell) speaks to a customer, it needs accurate tools to manage time. It cannot "guess" a schedule.

This workflow exposes three distinct **Webhook Endpoints** that serve as "Tools" for the AI:
1.  **`calendar_slots`**: "When are you free?" (Lists specific events/gaps).
2.  **`calendar_availability`**: "Are you free next Tuesday at 2 PM?" (Boolean check).
3.  **`calendar_set_appointment`**: "Great, I'll book that for you." (Writes to DB/Calendar).

It returns data in a structured JSON format compatible with OpenAI's **Tool Calling** schema (`toolCallId`).

## ‚öôÔ∏è Workflow Architecture
The system operates via three parallel execution paths based on the webhook triggered:

### 1. Slot Aggregation
*   **Trigger:** `POST /calendar_slots`
*   **Logic:** Fetches calendar data, aggregates raw items, and runs a **JavaScript Code Node** to normalize the data (e.g., formatting dates into human-readable strings like "Tomorrow at 2 PM").
*   **Output:** A JSON array of available times.

### 2. Availability Check
*   **Trigger:** `POST /calendar_availability`
*   **Logic:** Queries Google Calendar's `Free/Busy` API for a specific time window.
*   **Output:** Returns a success/failure status or specific conflict details.

### 3. Booking Execution
*   **Trigger:** `POST /calendar_set_appointment`
*   **Logic:** Receives `startTime`, `endTime`, and `attendeeEmail`. Creates a confirmed event in the primary calendar.
*   **Output:** Confirmation ID and status.

## üîå API / Tool Definitions
If connecting this to an AI Agent (e.g., Vapi/Retell), define your tools as follows:

### Endpoint: `/calendar_set_appointment`
**Description:** Book a meeting on the calendar.
```json
{
  "name": "bookMeeting",
  "description": "Books a slot on the calendar when the user confirms a time.",
  "parameters": {
    "type": "object",
    "properties": {
      "startTime": { "type": "string", "description": "ISO 8601 format date-time" },
      "email": { "type": "string", "description": "User's email address" }
    }
  }
}
```

### Endpoint: `/calendar_availability`
**Description:** Check if a specific time is free.
```json
{
  "name": "checkAvailability",
  "description": "Checks if the requested date and time is available.",
  "parameters": {
    "type": "object",
    "properties": {
      "queryTime": { "type": "string", "description": "ISO 8601 format date-time" }
    }
  }
}
```

## üõ†Ô∏è Setup Instructions

### 1. Prerequisites
*   **n8n Instance:** Self-hosted or Cloud.
*   **Google Cloud Console:** A project with **Google Calendar API** enabled.
*   **OAuth2 Credentials:** You must configure the `Google Calendar OAuth2` credential in n8n.

### 2. Installation
1.  **Import:** Copy the workflow JSON and paste it into your n8n canvas.
2.  **Authenticate:** Open the Google Calendar nodes and select your credential.
3.  **Update Calendar ID:** Change the `Calendar` field in the nodes from `babunaveen888@gmail.com` to your target calendar email (or use an expression).
4.  **Activate:** Toggle the workflow to **Active**.

### 3. Webhook Configuration
Note the URLs generated by the Webhook nodes (e.g., `https://your-n8n.com/webhook/calendar_slots`). You will paste these into your Voice Agent provider's "Server URL" or "Tool Configuration" settings.

## üíª Code Logic (Customization)
The **Code Node** allows for custom logic before responding to the AI. Currently, it includes a sample transformation:

```javascript
// Loop over input items and add metadata
for (const item of $input.all()) {
  item.json.myNewField = 1; // Example: Add lead score or region
}
return $input.all();
```
*Modify this section to format dates into "Spoken English" (e.g., transform `2023-10-25T14:00:00` to "Next Wednesday at 2 PM") for better AI pronunciation.*

## üìÑ License
This project is provided as-is. Ensure you handle PII (Personally Identifiable Information) according to your local data privacy regulations (GDPR/CCPA).

---
*Built with ‚ù§Ô∏è using n8n.*